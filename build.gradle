import groovy.json.JsonSlurper

task determineUpdate {
  doLast {
    final gradleVersionService = new URL('https://services.gradle.org/versions/current')
    final json = new JsonSlurper().parseText(gradleVersionService.text)
    final latestVersion = json.version
    final currentVersion = gradle.gradleVersion
    println "Latest version is $latestVersion"
    println "Current version is $currentVersion"

    if (currentVersion == latestVersion) {
      wrapper.enabled = false
    } else {
      wrapper.gradleVersion = latestVersion
    }
  }
}

wrapper.dependsOn determineUpdate
